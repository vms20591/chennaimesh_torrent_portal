<!DOCTYPE html>
<html lang="en" ng-app="torrentApp">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 

        <title>Torrent Portal - Chennai Mesh Network</title>
        
        <!-- Font Awesome CSS -->
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">

        <!-- Google Font CSS -->
        <link href='https://fonts.googleapis.com/css?family=Roboto|Bungee+Inline' rel='stylesheet' type='text/css'>
        
        <!-- Custom CSS  -->
        <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='css/style.css',_external=True)}}" />

        <!-- CSS Reset -->
        <link rel="stylesheet" href="{{url_for('static',filename='css/normalize.css',_external=True)}}">

        <!-- Milligram CSS minified -->
        <link rel="stylesheet" href="{{url_for('static',filename='css/milligram.min.css',_external=True)}}">

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="container" ng-controller="torrentHomeController">
            <div class="header">
                <div class="header-text">
                    <h3><a style="text-decoration:none;color:#FFFFFF;" href="{{url_for('main.index_view',_external=True)}}">Torrent Stash</a></h3>
                    <span>Community run place for open knowledge</span>
                </div>
            </div>
            <div class="row">
                <div class="column">
                    <div class="search-box">
                        <h2>Search</h2>
                        <div class="search-group">
                            <input class="input-search" ng-model="searchQuery" type="text"/>
                            <a class="search-icon fa fa-search" ng-click="searchTorrents();"></a>
                        </div>
                        <div style="text-align:center;" ng-switch on="searchState">
                            <i style="display:block;" ng-switch-when="1" ng-bind="errorText"></i>
                            <i style="display:block;color:red;" ng-switch-when="2" ng-bind="errorText"></i>
                            <i style="display:block;color:red;" ng-switch-when="3" ng-bind="errorText"></i>
                        </div>
                        <p>Search for your favorite torrents and magnets !</p>
                    </div>
                </div>
            </div>
           
            <div class="row">
                <div class="column hr">
                </div>
            </div>

            <div class="row">
                <div class="column">
                    <div class="search-result-box">
                        <h2>Results</h2>

                        <div ng-cloak ng-switch on="applicationState">
                            <img ng-switch-when="0" src="{{url_for('static',filename='img/ball.svg',_external=True)}}" alt="loading..."/>
                            <i style="display:block;" ng-switch-when="0">loading torrents...</i>

                            <table id="search-result-table" ng-switch-when="1">
                                <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>Torrent Name</th>
                                        <th>Category</th>
                                        <th>Torrent/Magnet</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="torrent in torrents">
                                        <td ng-bind="$index+1"></td>
                                        <td ng-bind="torrent.name"></td>
                                        <td ng-bind="torrent.category"></td>
                                        <td>
                                            <a ng-if="torrent.type==='magnet'" ng-href="{[{torrent.url}]}" class="no-decoration fa fa-magnet"></a> 
                                            <a ng-if="torrent.type==='torrent'" ng-href="{[{torrent.url}]}" class="no-decoration">Torrent</a> |         
                                            <a href="" class="no-decoration" ng-click="copiedToClipboard($index);" 
                                                ngclipboard data-clipboard-text="{[{torrent.url}]}">
                                                Clipboard
                                            </a>
                                            <span ng-class="{'copied-text':copied===$index,'hide':copied!==$index}">Copied!!!</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <h4 style="color:red;" ng-switch-when="2" ng-bind="errorText"></h4>
                            <h4 style="color:red;" ng-switch-when="3" ng-bind="errorText"></h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Script import  -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <script src="{{url_for('static',filename='js/ext/angular.js',_external=True)}}"></script>
        <script src="https://cdn.rawgit.com/zenorocha/clipboard.js/master/dist/clipboard.min.js"></script>
        <script src="https://raw.githubusercontent.com/sachinchoolur/ngclipboard/master/dist/ngclipboard.min.js"></script>
        <script src="{{url_for('static',filename='js/main/app/app.js',_external=True)}}"></script>
        <script src="{{url_for('static',filename='js/main/app/controller.js',_external=True)}}"></script>
        <script src="{{url_for('static',filename='js/main/app/service.js',_external=True)}}"></script>
    </body>
</html>
